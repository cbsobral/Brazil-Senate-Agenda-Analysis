library("congressbr")
library(tidyverse)
#library(rvest)
#library(httr)
library(jsonlite)
#library(plyr)
#library(readr)
library(glue)
senators <- sen_senator_list()
for(i in 1:80){
try({
endpoint <- glue(paste0("https://legis.senado.leg.br/dadosabertos/senador/",   senators$id[i], "/discursos"))
raw_json <- GET(endpoint, add_headers("Accept:application/json"))
parsed_json <- fromJSON(content(raw_json, "text"), flatten = TRUE)
str(parsed_json)
df <- parsed_json$DiscursosParlamentar$Parlamentar$Pronunciamentos$Pronunciamento
df <- df %>%
dplyr::select(CodigoPronunciamento, DataPronunciamento, SiglaPartidoParlamentarNaData, UfParlamentarNaData, SessaoPlenaria.NumeroSessao)
df$Id <- paste(as.character(senators$id[i]))
df$Nome <- paste(as.character(senators$name_senator[i]))
data_all<-rbind(data_all,df)
}, silent=FALSE)}
library(tidyverse)
library(rvest)
#library(httr)
library(jsonlite)
#library(plyr)
#library(readr)
library(glue)
for(i in 1:80){
try({
endpoint <- glue(paste0("https://legis.senado.leg.br/dadosabertos/senador/",   senators$id[i], "/discursos"))
raw_json <- GET(endpoint, add_headers("Accept:application/json"))
parsed_json <- fromJSON(content(raw_json, "text"), flatten = TRUE)
str(parsed_json)
df <- parsed_json$DiscursosParlamentar$Parlamentar$Pronunciamentos$Pronunciamento
df <- df %>%
dplyr::select(CodigoPronunciamento, DataPronunciamento, SiglaPartidoParlamentarNaData, UfParlamentarNaData, SessaoPlenaria.NumeroSessao)
df$Id <- paste(as.character(senators$id[i]))
df$Nome <- paste(as.character(senators$name_senator[i]))
data_all<-rbind(data_all,df)
}, silent=FALSE)}
#library(rvest)
library(httr)
for(i in 1:80){
try({
endpoint <- glue(paste0("https://legis.senado.leg.br/dadosabertos/senador/",   senators$id[i], "/discursos"))
raw_json <- GET(endpoint, add_headers("Accept:application/json"))
parsed_json <- fromJSON(content(raw_json, "text"), flatten = TRUE)
str(parsed_json)
df <- parsed_json$DiscursosParlamentar$Parlamentar$Pronunciamentos$Pronunciamento
df <- df %>%
dplyr::select(CodigoPronunciamento, DataPronunciamento, SiglaPartidoParlamentarNaData, UfParlamentarNaData, SessaoPlenaria.NumeroSessao)
df$Id <- paste(as.character(senators$id[i]))
df$Nome <- paste(as.character(senators$name_senator[i]))
data_all<-rbind(data_all,df)
}, silent=FALSE)}
